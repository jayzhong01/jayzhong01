var mapboxpro,CIRCLE_PARAM={center:[0,0],radius:100,unit:"meters",color:"#0000ff",opacity:.2,outlinecolor:"#ffffff",outlinewidth:3,dashline:void 0,circleStep:128,icon:{default:void 0,zoomIn:void 0,zoomOut:void 0},iconPosition:80,callback:null};!function(t){var e=(r.prototype.createMarker=function(){var n=this._param,s=this._geojson,c=this._source,l=document.createElement("img");l.src=n.icon.default;var u=this._marker=new mapboxgl.Marker({element:l,draggable:!0}).setLngLat([0,0]).addTo(this._map),h=100;function p(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}u.on("drag",function(){var t=[u.getLngLat().lng,u.getLngLat().lat],e=n.center,r=111325*p(e,t);h<r?l.setAttribute("src",n.icon.zoomIn):l.setAttribute("src",n.icon.zoomOut),h=r;var o={steps:n.circleStep,units:n.unit},i=turf.circle(e,r,o),a=i.geometry.coordinates[0][n.iconPosition];u.setLngLat(a),s.features[0]=i,c.setData(s)}),u.on("dragend",function(){var t,e,r;l.setAttribute("src",n.icon.default),n.callback&&(t=[u.getLngLat().lng,u.getLngLat().lat],r=111325*p(e=n.center,t),n.callback({radius:r,center:e}))})},r.prototype.createLayer=function(){var t=this._param,e=this._map,r=this._newGuid(),o=this._sourceId="circle_control_source_"+r;e.addSource(o,this._source);var i={id:"circle_control_layer_line_"+r,source:o,type:"line",paint:{"line-color":t.outlinecolor,"line-width":t.outlinewidth},filter:["all",["==","$type","Polygon"]]},a={id:"circle_control_layer_fill_"+r,source:o,type:"fill",paint:{"fill-color":t.color,"fill-opacity":t.opacity},filter:["all",["==","$type","Polygon"]]};e.addLayer(i),e.addLayer(a),this._layerIds.push(a.id,i.id),this._source=e.getSource(o)},r.prototype.createCircle=function(){var t=this._param,e=t.center,r={steps:t.circleStep,units:t.unit},o=turf.circle(e,t.radius,r),i=o.geometry.coordinates[0][t.iconPosition];this._marker.setLngLat(i),this._geojson.features.push(o),this._source.setData(this._geojson)},r.prototype.clear=function(){if(this._source&&0<this._layerIds.length){for(var t=0;t<this._layerIds.length;t++)this._map.removeLayer(this._layerIds[t]);this._map.removeSource(this._sourceId),this._marker.remove()}},r.prototype._newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},r);function r(t,e){this._geojson={type:"FeatureCollection",features:[]},this._source={type:"geojson",data:this._geojson},this._marker=null,this._sourceId=null,this._layerIds=[],this._map=t;var r=this._param=JSON.parse(JSON.stringify(CIRCLE_PARAM));for(var o in e)e[o]&&(r[o]=e[o]);this.createLayer(),this.createMarker(),this.createCircle()}t.CircleControl=e}(mapboxpro=mapboxpro||{});